df = ..
limit df to 50 transactions (copy)
mean transactions (copy)
df[last 50].copy()

sql = "SELECT id, MA50 FROM transactions sort id desc limit 1;"
new_data = ...
data = sql.fetch()
_ma50 = data[0][1]
NEW_MA50 = (_ma50 * 49 + new_data["Risk_Score"]) / 50